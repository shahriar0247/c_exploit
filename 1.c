#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <stdbool.h>




 int PATH_MAX = 20;
    FILE *fp;
    int status;
    char path[1024];




void shell(char command[1024]){
    char lol[1024];
    strncpy(lol, "", sizeof(lol));
      fp = popen(command, "r");
    if (fp == NULL)
        /* Handle error */;

    while (fgets(path, PATH_MAX, fp) != NULL)
        //printf(" 69 %s", path);
        {strncat(lol,path, 100);}
        lol[strlen(lol)-1] = 0;
        printf("%s", lol);
        

    status = pclose(fp);
}

bool StartsWith(const char *a, const char *b)
{
   if(strncmp(a, b, strlen(b)) == 0) return 1;
   return 0;
}


void slice_str(const char * str, char * buffer, size_t start, size_t end)
{
    size_t j = 0;
    for ( size_t i = start; i <= end; ++i ) {
        buffer[j++] = str[i];
    }
    buffer[j] = 0;
}

int main()
{
       char command[1024];
       char buffer[1024];

    while (1){
    shell("pwd");
    printf(" > ");
    fgets(command, 1024, stdin);
    if (command == "clear"){
        printf("[H[2J[3J");
    }
    else if (StartsWith(command, "cd ")) {
        
        slice_str(command, buffer, 3, sizeof(command));
        buffer[strlen(buffer)-1] = '\0';
       chdir(buffer);
        
    }
    else{
    shell(command);
    }printf("\n");
}
    return 0;
}
